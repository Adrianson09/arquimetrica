---
const links = [
  { href: '/', label: 'Inicio' },
  { href: '/quienes-somos', label: 'Quiénes somos' },
  { href: '/servicios', label: 'Servicios' },
  { href: '/proyectos', label: 'Proyectos' },
  { href: '/metodologia', label: 'Metodología' },
  { href: '/blog', label: 'Blog' },
  { href: '/contacto', label: 'Contacto' },
]
const instagram = 'https://www.instagram.com/arquimetrica.cr'
const linkedin = 'https://www.linkedin.com/company/arquimetrica'
---

<header class="sticky top-0 z-50 bg-white/95 backdrop-blur-md border-y-2 border-[var(--azul)] shadow-sm transition-all duration-300">
  <div class="container mx-auto px-4 sm:px-6 lg:px-8 h-16 flex items-center justify-between">
    
    <!-- Logo con hover suave -->
    <a href="/" class="flex items-center gap-3 group">
      <img 
        src="/ARQUIMETRICA-LOGO.png" 
        alt="Arquimétrica — Arquitectura e innovación" 
        class="h-16 w-auto transition-all duration-300 ease-out group-hover:scale-105 group-focus:outline-none group-focus:ring-2 group-focus:ring-[var(--azul)] group-focus:ring-offset-2 rounded-lg" 
      />
    </a>

    <!-- Menú desktop con underline animado -->
    <nav class="hidden md:flex md:items-center md:gap-6">
      {links.map(l => (
        <a 
          key={l.href}
          href={l.href}
          class="text-[var(--azul)] font-medium relative py-2 px-1 after:absolute after:bottom-0 after:left-0 after:w-0 after:h-0.5 after:bg-[var(--azul)] after:transition-all after:duration-300 after:ease-out hover:after:w-full focus:outline-none focus-visible:ring-2 focus-visible:ring-[var(--azul)] focus-visible:rounded"
          aria-current={Astro.url.pathname === l.href ? 'page' : undefined}
        >
          {l.label}
        </a>
      ))}
    </nav>

    <!-- Redes sociales -->
    <div class="hidden md:flex items-center gap-4">
      <a 
        href={instagram} 
        aria-label="Visita nuestro Instagram" 
        class="text-[var(--azul)] hover:text-[var(--azul-oscuro)] transition-colors duration-300 ease-out focus:outline-none focus-visible:ring-2 focus-visible:ring-[var(--azul)] rounded-full p-1.5"
        rel="noopener noreferrer" 
        target="_blank"
      >
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="h-6 w-6 fill-current transition-transform duration-300 hover:scale-110"><path d="M12 2.2c3.2 0 3.6 0 4.9.1 1.2.1 1.9.2 2.4.4.6.2 1 .5 1.5 1 .4.4.8.9 1 1.5.2.5.3 1.2.4 2.4.1 1.3.1 1.7.1 4.9s0 3.6-.1 4.9c-.1 1.2-.2 1.9-.4 2.4-.2.6-.5 1-1 1.5-.4.4-.9.8-1.5 1-.5.2-1.2.3-2.4.4-1.3.1-1.7.1-4.9.1s-3.6 0-4.9-.1c-1.2-.1-1.9-.2-2.4-.4a3.9 3.9 0 0 1-1.5-1c-.4-.4-.8-.9-1 1.5-.2-.5-.3-1.2-.4-2.4C2.2 15.6 2.2 15.2 2.2 12s0-3.6.1-4.9c.1-1.2.2-1.9.4-2.4.2-.6.5-1 1-1.5.4-.4.9-.8 1.5-1 .5-.2 1.2-.3 2.4-.4C8.4 2.2 8.8 2.2 12 2.2Zm0 1.8c-3.2 0-3.6 0-4.8.1-1 .1-1.5.2-1.9.3-.5.2-.8.4-1.1.7-.3.3-.6.6-.7 1.1-.1.4-.2.9-.3 1.9-.1 1.2-.1 1.6-.1 4.8s0 3.6.1 4.8c.1 1 .2 1.5.3 1.9.2.5.4.8.7 1.1.3.3.6.6 1.1.7.4.1.9.2 1.9.3 1.2.1 1.6.1 4.8.1s3.6 0 4.8-.1c1-.1 1.5-.2 1.9-.3.5-.2.8-.4 1.1-.7.3-.3.6-.6.7-1.1.1-.4.2-.9.3-1.9.1-1.2.1-1.6.1-4.8s0-3.6-.1-4.8c-.1-1-.2-1.5-.3-1.9a2.6 2.6 0 0 0-.7-1.1c-.3-.3-.6-.6-1.1-.7-.4-.1-.9-.2-1.9-.3-1.2-.1-1.6-.1-4.8-.1Zm0 3.5a6.5 6.5 0 1 1 0 13 6.5 6.5 0 0 1 0-13Zm0 2a4.5 4.5 0 1 0 0 9 4.5 4.5 0 0 0 0-9Zm5-2.8a1.5 1.5 0 1 0 0 3 1.5 1.5 0 0 0 0-3Z"/></svg>
      </a>
      <a 
        href={linkedin} 
        aria-label="Visita nuestro LinkedIn" 
        class="text-[var(--azul)] hover:text-[var(--azul-oscuro)] transition-colors duration-300 ease-out focus:outline-none focus-visible:ring-2 focus-visible:ring-[var(--azul)] rounded-full p-1.5"
        rel="noopener noreferrer" 
        target="_blank"
      >
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="h-6 w-6 fill-current transition-transform duration-300 hover:scale-110"><path d="M4.98 3.5C4.98 4.88 3.86 6 2.5 6S0 4.88 0 3.5 1.12 1 2.5 1s2.48 1.12 2.48 2.5zM.5 8.5h4V24h-4V8.5zM8.5 8.5h3.8v2.1h.1c.5-1 1.8-2.1 3.7-2.1 4 0 4.7 2.6 4.7 6V24h-4v-5.8c0-1.4 0-3.2-2-3.2s-2.3 1.5-2.3 3.1V24h-4V8.5z"/></svg>
      </a>
    </div>

    <!-- Botón hamburguesa -->
    <button 
      id="menu-toggle"
      class="md:hidden flex items-center justify-center p-2.5 rounded-lg text-[var(--azul)] hover:bg-[var(--azul)] hover:text-white focus:outline-none focus-visible:ring-2 focus-visible:ring-[var(--azul)] transition-all duration-300 ease-out"
      aria-expanded="false"
      aria-controls="mobile-menu"
      aria-label="Abrir menú de navegación"
    >
      <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 transition-transform duration-300 ease-out" fill="none" viewBox="0 0 24 24" stroke="currentColor" id="hamburger-icon">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
      </svg>
    </button>

  </div>

  <!-- Menú móvil animado -->
  <div 
    id="mobile-menu" 
    class="md:hidden fixed inset-x-0 top-16 bg-white border-t border-slate-200 shadow-lg transform transition-all duration-300 ease-out -translate-y-4 opacity-0 pointer-events-none z-40"
    role="menu"
    aria-label="Menú de navegación móvil"
  >
    <div class="px-4 pt-4 pb-4 space-y-1 sm:px-3">
      {links.map(l => (
        <a
          key={l.href}
          href={l.href}
          class="block px-4 py-3 rounded-lg text-base font-medium text-[var(--azul)] hover:bg-[var(--azul)] hover:text-white focus:bg-[var(--azul)] focus:text-white focus:outline-none focus-visible:ring-2 focus-visible:ring-[var(--azul)] transition-all duration-200 ease-out transform hover:translate-x-1"
          role="menuitem"
          aria-current={Astro.url.pathname === l.href ? 'page' : undefined}
        >
          {l.label}
        </a>
      ))}
      <div class="pt-3 pb-2 border-t border-slate-200 mt-2 flex items-center justify-center gap-6">
        <a 
          href={instagram} 
          aria-label="Instagram" 
          class="text-[var(--azul)] hover:text-[var(--azul-oscuro)] p-2.5 focus:outline-none focus-visible:ring-2 focus-visible:ring-[var(--azul)] rounded-full transition-transform duration-300 hover:scale-110"
          rel="noopener noreferrer" 
          target="_blank"
        >
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="h-6 w-6 fill-current"><path d="M12 2.2c3.2 0 3.6 0 4.9.1 1.2.1 1.9.2 2.4.4.6.2 1 .5 1.5 1 .4.4.8.9 1 1.5.2.5.3 1.2.4 2.4.1 1.3.1 1.7.1 4.9s0 3.6-.1 4.9c-.1 1.2-.2 1.9-.4 2.4-.2.6-.5 1-1 1.5-.4.4-.9.8-1.5 1-.5.2-1.2.3-2.4.4-1.3.1-1.7.1-4.9.1s-3.6 0-4.9-.1c-1.2-.1-1.9-.2-2.4-.4a3.9 3.9 0 0 1-1.5-1c-.4-.4-.8-.9-1 1.5-.2-.5-.3-1.2-.4-2.4C2.2 15.6 2.2 15.2 2.2 12s0-3.6.1-4.9c.1-1.2.2-1.9.4-2.4.2-.6.5-1 1-1.5.4-.4.9-.8 1.5-1 .5-.2 1.2-.3 2.4-.4C8.4 2.2 8.8 2.2 12 2.2Zm0 1.8c-3.2 0-3.6 0-4.8.1-1 .1-1.5.2-1.9.3-.5.2-.8.4-1.1.7-.3.3-.6.6-.7 1.1-.1.4-.2.9-.3 1.9-.1 1.2-.1 1.6-.1 4.8s0 3.6.1 4.8c.1 1 .2 1.5.3 1.9.2.5.4.8.7 1.1.3.3.6.6 1.1.7.4.1.9.2 1.9.3 1.2.1 1.6.1 4.8.1s3.6 0 4.8-.1c1-.1 1.5-.2 1.9-.3.5-.2.8-.4 1.1-.7.3-.3.6-.6.7-1.1.1-.4.2-.9.3-1.9.1-1.2.1-1.6.1-4.8s0-3.6-.1-4.8c-.1-1-.2-1.5-.3-1.9a2.6 2.6 0 0 0-.7-1.1c-.3-.3-.6-.6-1.1-.7-.4-.1-.9-.2-1.9-.3-1.2-.1-1.6-.1-4.8-.1Zm0 3.5a6.5 6.5 0 1 1 0 13 6.5 6.5 0 0 1 0-13Zm0 2a4.5 4.5 0 1 0 0 9 4.5 4.5 0 0 0 0-9Zm5-2.8a1.5 1.5 0 1 0 0 3 1.5 1.5 0 0 0 0-3Z"/></svg>
        </a>
        <a 
          href={linkedin} 
          aria-label="LinkedIn" 
          class="text-[var(--azul)] hover:text-[var(--azul-oscuro)] p-2.5 focus:outline-none focus-visible:ring-2 focus-visible:ring-[var(--azul)] rounded-full transition-transform duration-300 hover:scale-110"
          rel="noopener noreferrer" 
          target="_blank"
        >
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="h-6 w-6 fill-current"><path d="M4.98 3.5C4.98 4.88 3.86 6 2.5 6S0 4.88 0 3.5 1.12 1 2.5 1s2.48 1.12 2.48 2.5zM.5 8.5h4V24h-4V8.5zM8.5 8.5h3.8v2.1h.1c.5-1 1.8-2.1 3.7-2.1 4 0 4.7 2.6 4.7 6V24h-4v-5.8c0-1.4 0-3.2-2-3.2s-2.3 1.5-2.3 3.1V24h-4V8.5z"/></svg>
        </a>
      </div>
    </div>
  </div>
</header>

<script>
  document.addEventListener('DOMContentLoaded', () => {
    const menuToggle = document.getElementById('menu-toggle');
    const mobileMenu = document.getElementById('mobile-menu');
    const icon = document.getElementById('hamburger-icon');

    if (!menuToggle || !mobileMenu || !icon) return;

    const openMenu = () => {
      menuToggle.setAttribute('aria-expanded', 'true');
      mobileMenu.classList.remove('pointer-events-none', '-translate-y-4', 'opacity-0');
      mobileMenu.classList.add('translate-y-0', 'opacity-100');
      
      // Animar ícono a X
      icon.innerHTML = `<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />`;
    };

    const closeMenu = () => {
      menuToggle.setAttribute('aria-expanded', 'false');
      mobileMenu.classList.remove('translate-y-0', 'opacity-100');
      mobileMenu.classList.add('pointer-events-none', '-translate-y-4', 'opacity-0');
      
      // Animar ícono a hamburguesa
      icon.innerHTML = `<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />`;
    };

    menuToggle.addEventListener('click', () => {
      const isExpanded = menuToggle.getAttribute('aria-expanded') === 'true';
      isExpanded ? closeMenu() : openMenu();
    });

    // Cerrar al hacer clic en un enlace
    mobileMenu.querySelectorAll('a').forEach(link => {
      link.addEventListener('click', closeMenu);
    });

    // Opcional: cerrar al hacer scroll
    /*
    window.addEventListener('scroll', () => {
      if (menuToggle.getAttribute('aria-expanded') === 'true') {
        closeMenu();
      }
    }, { passive: true });
    */
  });
</script>